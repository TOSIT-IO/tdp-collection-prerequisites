# Copyright 2022 TOSIT.IO
# SPDX-License-Identifier: Apache-2.0

---
# Adapted from https://github.com/kubernetes-sigs/kubespray/blob/v2.16.0/roles/bootstrap-os/tasks/bootstrap-centos.yml
- name: Add proxy to yum.conf or dnf.conf if http_proxy is defined
  ini_file:
    path: "{{ ( (ansible_distribution_major_version | int) < 8) | ternary('/etc/yum.conf','/etc/dnf/dnf.conf') }}"
    section: main
    option: proxy
    value: "{{ http_proxy | default(omit) }}"
    state: "{{ http_proxy | default(False) | ternary('present', 'absent') }}"
    no_extra_spaces: true

- name: Install common packages
  yum:
    name:
      - vim
      - java-1.8.0-openjdk
      - wget
      - curl
      - unzip
      - nc
      - expect
      # Installing python2-setuptools required by the Ansible pip module
      - python2-setuptools
      - python3
      - python3-pip
      - python3-setuptools
    state: present
